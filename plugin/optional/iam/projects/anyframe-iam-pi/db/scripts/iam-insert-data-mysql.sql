CREATE TABLE DIRECTOR (
  DIRECTOR_ID VARCHAR  (20)  NOT NULL,
  NAME 		  VARCHAR  (20)  NOT NULL,
  MOVIES	  VARCHAR  (255),
  CONSTRAINT PK_DIRECTOR 
  PRIMARY KEY ( DIRECTOR_ID ) ) ;
  
  -- IAM DB Schema
CREATE TABLE GROUPS ( 
  GROUP_ID     VARCHAR (20)  NOT NULL, 
  GROUP_NAME   VARCHAR (50)  NOT NULL, 
  CREATE_DATE  VARCHAR (8), 
  MODIFY_DATE  VARCHAR (8), 
  CONSTRAINT PK_IAM_GROUPS
  PRIMARY KEY ( GROUP_ID ) ) ; 

CREATE TABLE GROUPS_HIERARCHY ( 
  PARENT_GROUP  VARCHAR (20)  NOT NULL, 
  CHILD_GROUP   VARCHAR (20)  NOT NULL, 
  CREATE_DATE   VARCHAR (8), 
  MODIFY_DATE   VARCHAR (8), 
  CONSTRAINT PK_GROUPS_HIERARCHY PRIMARY KEY ( PARENT_GROUP, CHILD_GROUP ),
  CONSTRAINT FK_GROUPS1 FOREIGN KEY (PARENT_GROUP) REFERENCES GROUPS (GROUP_ID),
  CONSTRAINT FK_GROUPS2 FOREIGN KEY (CHILD_GROUP) REFERENCES GROUPS (GROUP_ID) ) ; 

CREATE TABLE USERS ( 
  USER_ID      VARCHAR (20)  NOT NULL, 
  USER_NAME    VARCHAR (50)  NOT NULL, 
  PASSWORD     VARCHAR (50)  NOT NULL, 
  ENABLED      VARCHAR (1), 
  CREATE_DATE  VARCHAR (8), 
  MODIFY_DATE  VARCHAR (8), 
  CONSTRAINT PK_USERS
  PRIMARY KEY ( USER_ID ) ) ; 

CREATE TABLE GROUPS_USERS ( 
  GROUP_ID     VARCHAR (20)  NOT NULL, 
  USER_ID      VARCHAR (20)  NOT NULL, 
  CREATE_DATE  VARCHAR (8), 
  MODIFY_DATE  VARCHAR (8), 
  CONSTRAINT PK_GROUPS_USERS PRIMARY KEY ( GROUP_ID, USER_ID ),
  CONSTRAINT FK_GROUPS_USERS_GROUP_ID FOREIGN KEY (GROUP_ID) REFERENCES GROUPS (GROUP_ID),
  CONSTRAINT FK_GROUPS_USERS_USER_ID FOREIGN KEY (USER_ID) REFERENCES USERS (USER_ID) ) ; 

CREATE TABLE ROLES ( 
  ROLE_ID      VARCHAR (50)  NOT NULL, 
  ROLE_NAME    VARCHAR (50), 
  DESCRIPTION  VARCHAR (100), 
  CREATE_DATE  VARCHAR (8), 
  MODIFY_DATE  VARCHAR (8), 
  CONSTRAINT PK_ROLES PRIMARY KEY ( ROLE_ID ) ) ; 

CREATE TABLE ROLES_HIERARCHY ( 
  PARENT_ROLE  VARCHAR (50)  NOT NULL, 
  CHILD_ROLE   VARCHAR (50)  NOT NULL, 
  CREATE_DATE  VARCHAR (8), 
  MODIFY_DATE  VARCHAR (8), 
  CONSTRAINT PK_ROLES_HIERARCHY PRIMARY KEY ( PARENT_ROLE, CHILD_ROLE ),
  CONSTRAINT FK_ROLES1 FOREIGN KEY(PARENT_ROLE) REFERENCES ROLES(ROLE_ID),
  CONSTRAINT FK_ROLES2 FOREIGN KEY(CHILD_ROLE) REFERENCES ROLES (ROLE_ID) ) ; 

CREATE TABLE SECURED_RESOURCES ( 
  RESOURCE_ID       VARCHAR (10)  NOT NULL, 
  SYSTEM_NAME       VARCHAR (15),
  RESOURCE_NAME     VARCHAR (50), 
  RESOURCE_PATTERN  VARCHAR (300)  NOT NULL, 
  DESCRIPTION       VARCHAR (100), 
  RESOURCE_TYPE     VARCHAR (10)  NOT NULL, 
  SORT_ORDER        NUMERIC, 
  CREATE_DATE       VARCHAR (8), 
  MODIFY_DATE       VARCHAR (8), 
  CONSTRAINT PK_RECURED_RESOURCES
  PRIMARY KEY ( RESOURCE_ID ) ) ; 

CREATE TABLE SECURED_RESOURCES_ROLES ( 
  RESOURCE_ID  VARCHAR (10)  NOT NULL, 
  ROLE_ID      VARCHAR (50)  NOT NULL, 
  CREATE_DATE  VARCHAR (8), 
  MODIFY_DATE  VARCHAR (8), 
  CONSTRAINT PK_SECURED_RESOURCES_ROLES PRIMARY KEY ( RESOURCE_ID, ROLE_ID ),
  CONSTRAINT FK_SECURED_RESOURCES FOREIGN KEY(RESOURCE_ID) REFERENCES SECURED_RESOURCES(RESOURCE_ID),
  CONSTRAINT FK_ROLES4 FOREIGN KEY (ROLE_ID) REFERENCES ROLES(ROLE_ID) ) ;
  
CREATE TABLE AUTHORITIES ( 
  ROLE_ID      VARCHAR (50)  NOT NULL, 
  SUBJECT_ID   VARCHAR (20)  NOT NULL, 
  TYPE         VARCHAR (2)  NOT NULL, 
  CREATE_DATE  VARCHAR (8), 
  MODIFY_DATE  VARCHAR (8), 
  CONSTRAINT PK_AUTHORITIES PRIMARY KEY ( ROLE_ID, SUBJECT_ID ),
  CONSTRAINT FK_ROLES3 FOREIGN KEY(ROLE_ID) REFERENCES ROLES(ROLE_ID) ) ; 
  
CREATE TABLE RESTRICTED_TIMES (
	TIME_ID		VARCHAR (10) NOT NULL,
	SYSTEM_NAME VARCHAR (15) NOT NULL,
	TIME_TYPE	VARCHAR (10) NOT NULL, -- crash, holiday, weekend, improve, daily
	START_DATE	VARCHAR (8),
	START_TIME	VARCHAR (6) NOT NULL,
	END_DATE	VARCHAR (8),
	END_TIME	VARCHAR (6) NOT NULL,
	DESCRIPTION	VARCHAR (100),
	CONSTRAINT PK_RESTRICTED_TIMES PRIMARY KEY(TIME_ID)
);

CREATE TABLE RESTRICTED_TIMES_RESOURCES (
	TIME_ID VARCHAR (10) NOT NULL,
	RESOURCE_ID VARCHAR (10) NOT NULL,
	CONSTRAINT PK_RESTRICTED_TIMES_RESOURCES  PRIMARY KEY(TIME_ID, RESOURCE_ID),
	CONSTRAINT FK_TIMES_RESOURCES_TIME_ID FOREIGN KEY (TIME_ID) REFERENCES RESTRICTED_TIMES(TIME_ID),
	CONSTRAINT FK_TIMES_RESOURCES_RESOURCE_ID FOREIGN KEY(RESOURCE_ID) REFERENCES SECURED_RESOURCES(RESOURCE_ID)
);

CREATE TABLE TIMES_RESOURCES_EXCLUSION (
	TIME_ID VARCHAR (10) NOT NULL,
	RESOURCE_ID VARCHAR (10) NOT NULL,
	ROLE_ID	VARCHAR (50) NOT NULL,
	CONSTRAINT PK_EXCLUSION  PRIMARY KEY(TIME_ID, RESOURCE_ID, ROLE_ID),
	CONSTRAINT FK_EXCLUSION_TIME_ID FOREIGN KEY (TIME_ID) REFERENCES RESTRICTED_TIMES(TIME_ID),
	CONSTRAINT FK_EXCLUSION_RESOURCE_ID FOREIGN KEY(RESOURCE_ID) REFERENCES SECURED_RESOURCES(RESOURCE_ID),
	CONSTRAINT FK_EXCLUSION_ROLE_ID FOREIGN KEY(ROLE_ID) REFERENCES ROLES(ROLE_ID)
);

CREATE TABLE RESTRICTED_TIMES_ROLES (
	TIME_ID VARCHAR (10) NOT NULL,
	ROLE_ID VARCHAR (50) NOT NULL,
	CONSTRAINT PK_RESTRICTED_TIMES_ROLES  PRIMARY KEY(TIME_ID, ROLE_ID),
	CONSTRAINT FK_TIMES_ROLES_TIME_ID FOREIGN KEY (TIME_ID) REFERENCES RESTRICTED_TIMES(TIME_ID),
	CONSTRAINT FK_TIMES_ROLES_ROLE_ID FOREIGN KEY(ROLE_ID) REFERENCES ROLES(ROLE_ID)
);

CREATE TABLE VIEW_RESOURCES  (
	VIEW_RESOURCE_ID 	VARCHAR (50) NOT NULL,
    SYSTEM_NAME VARCHAR (15),
	CATEGORY	VARCHAR (255),
	VIEW_NAME	VARCHAR (50) NOT NULL,
	DESCRIPTION	VARCHAR (255) NOT NULL,
	VIEW_INFO	VARCHAR (255),
	VIEW_TYPE	VARCHAR (10) NOT NULL,
	VISIBLE		VARCHAR (1) NOT NULL,
	CONSTRAINT PK_VIEW_RESOURCES  PRIMARY KEY(VIEW_RESOURCE_ID)
);

CREATE TABLE VIEW_RESOURCES_MAPPING  (
	VIEW_RESOURCE_ID VARCHAR (50) NOT NULL,
	REF_ID VARCHAR (50) NOT NULL,		
	MASK INTEGER NOT NULL,
	PERMISSIONS VARCHAR (255) NOT NULL,
	REF_TYPE VARCHAR (10) NOT NULL,
	CONSTRAINT PK_VIEW_RESOURCES_MAPPING  PRIMARY KEY(VIEW_RESOURCE_ID, REF_ID),
	CONSTRAINT FK_MAPPING_VIEW_RESOURCE_ID  FOREIGN KEY (VIEW_RESOURCE_ID) REFERENCES VIEW_RESOURCES (VIEW_RESOURCE_ID)
);

CREATE TABLE VIEW_HIERARCHY	(
	PARENT_VIEW	VARCHAR (50) NOT NULL,
	CHILD_VIEW	VARCHAR (50) NOT NULL,
	CREATE_DATE VARCHAR (8),
	MODIFY_DATE VARCHAR (8),
	CONSTRAINT PK_VIEW_HIERARCHY PRIMARY KEY(PARENT_VIEW, CHILD_VIEW),
	CONSTRAINT FK_VIEW1 FOREIGN KEY (PARENT_VIEW) REFERENCES VIEW_RESOURCES (VIEW_RESOURCE_ID), 
	CONSTRAINT FK_VIEW2 FOREIGN KEY (CHILD_VIEW) REFERENCES VIEW_RESOURCES (VIEW_RESOURCE_ID)
);
  
CREATE TABLE CANDIDATE_SECURED_RESOURCES (
	CANDIDATE_RESOURCE_ID	VARCHAR (10)	NOT NULL,
	SYSTEM_NAME				VARCHAR (15),
	BEANID					VARCHAR (128),
	PACKAGES				VARCHAR (128)	NOT NULL,
	CLASSES					VARCHAR (128),
	METHOD					VARCHAR (128),
	PARAMETER				VARCHAR (128),
	REQUESTMAPPING			VARCHAR (128),
	POINTCUT				VARCHAR (128),
	CANDIDATE_RESOURCE_TYPE	VARCHAR (10)	NOT NULL,
	CONSTRAINT	PK_CANDIDATE_SECURED_RESOURCES	PRIMARY KEY(CANDIDATE_RESOURCE_ID)
);

CREATE TABLE DATA_UPLOAD (
	FILE_ID VARCHAR (14) NOT NULL,
	PATH VARCHAR (255) NOT NULL,
	FILE_NAME VARCHAR (255) NOT NULL,
	CREATE_DATE VARCHAR (8) NOT NULL,
	WORK_DATE VARCHAR (8),
	CONSTRAINT PK_DATA_UPLOAD PRIMARY KEY(FILE_ID)
);

-- password encoding MD5 - user_id + 123
insert into GROUPS values('GRP-P001','HeadQuarter','20090701','20091209');
insert into GROUPS values('GRP-P002','Manufacturing Cen.','20090701','20091209');
insert into GROUPS_HIERARCHY values('GRP-P001','GRP-P002','20090701',NULL);
insert into USERS values('admin','Admin User','admin123','Y','20090630',NULL);
insert into USERS values('user','General user','user123','Y','20090909',NULL);
insert into USERS values('buyer','Buyer','buyer123','Y','20090909',NULL);
insert into GROUPS_USERS values('GRP-P001','admin','20091102',NULL);
insert into GROUPS_USERS values('GRP-P001','user','20100104',NULL);
insert into GROUPS_USERS values('GRP-P001','buyer','20091008',NULL);
insert into ROLES values('IS_AUTHENTICATED_ANONYMOUSLY','IS_AUTHENTICATED_ANONYMOUSLY','ANONYMOUSLY Role','20091103',NULL);
insert into ROLES values('ROLE_RESTRICTED','ROLE_RESTRICTED','Restricted Role','20091103',NULL);
insert into ROLES values('ROLE_USER','ROLE_USER','USER Role','20091103',NULL);
insert into ROLES values('ROLE_ADMIN','ROLE_ADMIN','ADMIN Role','20091103',NULL);
insert into ROLES_HIERARCHY values('IS_AUTHENTICATED_ANONYMOUSLY','ROLE_RESTRICTED','20091103',NULL);
insert into ROLES_HIERARCHY values('ROLE_RESTRICTED','ROLE_USER','20091103',NULL);
insert into ROLES_HIERARCHY values('ROLE_USER','ROLE_ADMIN','20091103',NULL);
insert into SECURED_RESOURCES values('PNC-P00001','SAMPLE','List','execution(* anyframe.iam.core..*Service.*Bbnydory(..))','','pointcut',1,'20100107',NULL);
INSERT INTO SECURED_RESOURCES VALUES('WEB-P00002','SAMPLE','User Update','\\A/iamUpdateDirector\\\.do\\Z','','url',1,'20100107',NULL);
INSERT INTO SECURED_RESOURCES VALUES('WEB-P00003','SAMPLE','Director List','\\A/iamListDirector\\\.do\\Z','','url',2,'20100107',NULL);
INSERT INTO SECURED_RESOURCES_ROLES VALUES('PNC-P00001','ROLE_USER','20100107',NULL);
INSERT INTO SECURED_RESOURCES_ROLES VALUES('WEB-P00002','ROLE_ADMIN','20100107',NULL);
INSERT INTO SECURED_RESOURCES_ROLES VALUES('WEB-P00003','ROLE_USER','20100107',NULL);
insert into AUTHORITIES values('ROLE_ADMIN','admin','U','20091103',NULL);
insert into AUTHORITIES values('ROLE_USER','user','U','20091103',NULL);
insert into AUTHORITIES values('ROLE_RESTRICTED','buyer','U','20100422',NULL);
insert into VIEW_RESOURCES values('downloadUser','SAMPLE','User Management','Download User','Download User Infomation','','button','Y');
insert into VIEW_RESOURCES values('viewManagement','SAMPLE','View Management','View Management','View Management','','menu','Y');
insert into VIEW_RESOURCES_MAPPING values('viewManagement','ROLE_ADMIN',1,'READ','ROLE');
insert into VIEW_HIERARCHY values('downloadUser','viewManagement','20100526',NULL);
INSERT INTO DIRECTOR VALUES('DIRECTOR-01','Timothy Burton','Alice in Wonderland');
INSERT INTO DIRECTOR VALUES('DIRECTOR-02','James Cameron','Avatar');
INSERT INTO DIRECTOR VALUES('DIRECTOR-03','Paul Greengrass','Green Zone');
INSERT INTO DIRECTOR VALUES('DIRECTOR-04','Allen Coulter','Remember Me');
INSERT INTO DIRECTOR VALUES('DIRECTOR-05','Jim Field Smith','She is Out of My League');
commit;